{"instance_id": "astropy__astropy-12907", "model_patch": "", "model_name_or_path": "CodeAgent-v1"}
{"instance_id": "astropy__astropy-12907", "model_patch": "", "model_name_or_path": "CodeAgent-v1"}
{"instance_id": "astropy__astropy-12907", "model_patch": "", "model_name_or_path": "CodeAgent-v1"}
{"instance_id": "astropy__astropy-12907", "model_patch": "diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\nindex a308e27297..6e457cc93a 100644\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -199,6 +199,23 @@ def _coord_matrix(model, pos, noutp):\n         else:\n             mat[-model.n_outputs:, -model.n_inputs:] = m\n         return mat\n+    \n+    # Handle CompoundModel by calling _separable recursively\n+    if isinstance(model, CompoundModel):\n+        # Get the coordinate matrix for the compound model\n+        coord_mat = _separable(model)\n+        # Pad or adjust the matrix based on position\n+        if pos == 'left':\n+            # Place at the beginning\n+            result = np.zeros((noutp, model.n_inputs))\n+            result[:coord_mat.shape[0], :coord_mat.shape[1]] = coord_mat\n+            return result\n+        else:\n+            # Place at the end\n+            result = np.zeros((noutp, model.n_inputs))\n+            result[-coord_mat.shape[0]:, -coord_mat.shape[1]:] = coord_mat\n+            return result\n+    \n     if not model.separable:\n         # this does not work for more than 2 coordinates\n         mat = np.zeros((noutp, model.n_inputs))\n@@ -215,7 +232,6 @@ def _coord_matrix(model, pos, noutp):\n             mat = np.roll(mat, (noutp - model.n_outputs))\n     return mat\n \n-\n def _cstack(left, right):\n     \"\"\"\n     Function corresponding to '&' operation.\n", "model_name_or_path": "CodeAgent-v1"}
